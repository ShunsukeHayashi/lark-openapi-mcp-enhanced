{
  "automation_rules": {
    "alert_rules": [
      {
        "rule_id": "pipeline_stagnation_alert",
        "name": "æ¡ˆä»¶åœæ»ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "description": "å•†è«‡æ®µéšã®æ¡ˆä»¶ãŒ2é€±é–“æ›´æ–°ã•ã‚Œã¦ã„ãªã„å ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "trigger": {
          "type": "scheduled",
          "frequency": "daily",
          "time": "09:00"
        },
        "conditions": [
          {
            "field": "å–¶æ¥­æ®µéš",
            "operator": "equals",
            "value": "å•†è«‡"
          },
          {
            "field": "æ›´æ–°æ—¥",
            "operator": "older_than",
            "value": "14",
            "unit": "days"
          }
        ],
        "actions": [
          {
            "type": "notification",
            "recipients": [
              "{æ‹…å½“è€…}",
              "{æ‹…å½“è€….manager}"
            ],
            "message": "æ¡ˆä»¶ã€Œ{æ¡ˆä»¶å}ã€ãŒ2é€±é–“æ›´æ–°ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é¡§å®¢: {é¡§å®¢å}ã€äºˆæƒ³å£²ä¸Š: {äºˆæƒ³å£²ä¸Šé‡‘é¡}å††",
            "channels": ["lark_message", "email"]
          },
          {
            "type": "field_update",
            "field": "å‚™è€ƒ",
            "value": "è‡ªå‹•ã‚¢ãƒ©ãƒ¼ãƒˆ: {TODAY()}ã«åœæ»ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã—ã¾ã—ãŸ"
          }
        ]
      },
      {
        "rule_id": "followup_overdue_alert",
        "name": "ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æœŸé™åˆ‡ã‚Œã‚¢ãƒ©ãƒ¼ãƒˆ",
        "description": "æ´»å‹•å±¥æ­´ã®æ¬¡å›äºˆå®šæ—¥ãŒéå»ã«ãªã£ãŸå ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "trigger": {
          "type": "scheduled",
          "frequency": "daily",
          "time": "09:00"
        },
        "conditions": [
          {
            "field": "æ¬¡å›äºˆå®šæ—¥",
            "operator": "less_than",
            "value": "TODAY()"
          },
          {
            "field": "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
            "operator": "equals",
            "value": "äºˆå®š"
          }
        ],
        "actions": [
          {
            "type": "notification",
            "recipients": ["{æ‹…å½“è€…}"],
            "message": "é¡§å®¢ã€Œ{é¡§å®¢å}ã€ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æœŸé™ãŒéãã¦ã„ã¾ã™ã€‚äºˆå®šå†…å®¹: {æ¬¡å›äºˆå®šå†…å®¹}",
            "channels": ["lark_message"]
          }
        ]
      },
      {
        "rule_id": "monthly_target_progress_alert",
        "name": "æœˆæ¬¡ç›®æ¨™é€²æ—ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "description": "æœˆæœ«5æ—¥å‰ã§é”æˆç‡ãŒ70%æœªæº€ã®å ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "trigger": {
          "type": "scheduled",
          "frequency": "daily",
          "time": "10:00"
        },
        "conditions": [
          {
            "field": "é”æˆç‡",
            "operator": "less_than",
            "value": 70
          },
          {
            "custom_condition": "DAYS_UNTIL_MONTH_END() <= 5"
          }
        ],
        "actions": [
          {
            "type": "notification",
            "recipients": [
              "{æ‹…å½“è€…}",
              "{æ‹…å½“è€….manager}"
            ],
            "message": "æœˆæ¬¡ç›®æ¨™ã®é”æˆç‡ãŒ{é”æˆç‡}%ã§ã™ã€‚ç›®æ¨™: {æœˆæ¬¡å£²ä¸Šç›®æ¨™}å††ã€å®Ÿç¸¾: {å®Ÿç¸¾å£²ä¸Š}å††",
            "channels": ["lark_message", "email"]
          }
        ]
      },
      {
        "rule_id": "high_value_deal_alert",
        "name": "é«˜é¡æ¡ˆä»¶ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "description": "500ä¸‡å††ä»¥ä¸Šã®æ¡ˆä»¶ãŒæˆç´„æ®µéšã«é€²ã‚“ã å ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ",
        "trigger": {
          "type": "field_change",
          "field": "å–¶æ¥­æ®µéš"
        },
        "conditions": [
          {
            "field": "å–¶æ¥­æ®µéš",
            "operator": "changed_to",
            "value": "æˆç´„"
          },
          {
            "field": "äºˆæƒ³å£²ä¸Šé‡‘é¡",
            "operator": "greater_than",
            "value": 5000000
          }
        ],
        "actions": [
          {
            "type": "notification",
            "recipients": ["@channel"],
            "message": "ğŸ‰ é«˜é¡æ¡ˆä»¶æˆç´„ï¼æ¡ˆä»¶ã€Œ{æ¡ˆä»¶å}ã€ï¼ˆ{äºˆæƒ³å£²ä¸Šé‡‘é¡}å††ï¼‰ãŒæˆç´„ã—ã¾ã—ãŸã€‚æ‹…å½“: {æ‹…å½“è€…}",
            "channels": ["lark_message"]
          }
        ]
      }
    ],
    "workflow_automations": [
      {
        "automation_id": "pipeline_stage_progression",
        "name": "å–¶æ¥­æ®µéšè‡ªå‹•é€²è¡Œ",
        "description": "ç‰¹å®šæ¡ä»¶ã§å–¶æ¥­æ®µéšã‚’è‡ªå‹•é€²è¡Œ",
        "trigger": {
          "type": "field_change",
          "field": "æ´»å‹•ã‚¿ã‚¤ãƒ—"
        },
        "rules": [
          {
            "condition": {
              "field": "æ´»å‹•ã‚¿ã‚¤ãƒ—",
              "operator": "equals",
              "value": "ãƒ—ãƒ¬ã‚¼ãƒ³"
            },
            "action": {
              "type": "field_update",
              "target_table": "tbl_sales_pipeline",
              "field": "å–¶æ¥­æ®µéš",
              "value": "ææ¡ˆ"
            }
          }
        ]
      },
      {
        "automation_id": "customer_status_update",
        "name": "é¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è‡ªå‹•æ›´æ–°",
        "description": "æ´»å‹•å±¥æ­´ã«åŸºã¥ãé¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è‡ªå‹•æ›´æ–°",
        "trigger": {
          "type": "record_created",
          "table": "tbl_activity_history"
        },
        "rules": [
          {
            "condition": {
              "field": "é¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
              "operator": "equals",
              "value": "è¦‹è¾¼ã¿å®¢"
            },
            "action": {
              "type": "field_update",
              "target_table": "tbl_customer_management",
              "field": "é¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
              "value": "æ—¢å­˜å®¢"
            }
          },
          {
            "action": {
              "type": "field_update",
              "target_table": "tbl_customer_management",
              "field": "æœ€çµ‚æ¥è§¦æ—¥",
              "value": "{å®Ÿæ–½æ—¥}"
            }
          }
        ]
      },
      {
        "automation_id": "deal_completion_processing",
        "name": "æ¡ˆä»¶å®Œäº†æ™‚å‡¦ç†",
        "description": "æ¡ˆä»¶ãŒå®Œäº†çŠ¶æ…‹ã«ãªã£ãŸæ™‚ã®è‡ªå‹•å‡¦ç†",
        "trigger": {
          "type": "field_change",
          "field": "å–¶æ¥­æ®µéš"
        },
        "rules": [
          {
            "condition": {
              "field": "å–¶æ¥­æ®µéš",
              "operator": "changed_to",
              "value": "å®Œäº†"
            },
            "actions": [
              {
                "type": "create_record",
                "target_table": "tbl_activity_history",
                "fields": {
                  "æ´»å‹•ã‚¿ã‚¤ãƒ—": "ãã®ä»–",
                  "é¡§å®¢å": "{é¡§å®¢å}",
                  "æ¡ˆä»¶å": "{æ¡ˆä»¶å}",
                  "å®Ÿæ–½æ—¥": "TODAY()",
                  "æ‹…å½“è€…": "{æ‹…å½“è€…}",
                  "æ´»å‹•å†…å®¹": "æ¡ˆä»¶å®Œäº† - å£²ä¸Šé‡‘é¡: {äºˆæƒ³å£²ä¸Šé‡‘é¡}å††",
                  "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹": "å®Œäº†"
                }
              },
              {
                "type": "field_update",
                "target_table": "tbl_customer_management",
                "field": "é¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
                "value": "æ—¢å­˜å®¢"
              }
            ]
          }
        ]
      }
    ],
    "calculated_fields": {
      "tbl_sales_pipeline": [
        {
          "field_name": "è¦‹è¾¼ã¿å£²ä¸Š",
          "formula": "IF({äºˆæƒ³å£²ä¸Šé‡‘é¡} != BLANK(), {äºˆæƒ³å£²ä¸Šé‡‘é¡} * {ç¢ºåº¦} / 100, 0)",
          "description": "äºˆæƒ³å£²ä¸Šé‡‘é¡ã«ç¢ºåº¦ã‚’æ›ã‘ãŸåŠ é‡å£²ä¸Š"
        },
        {
          "field_name": "æ¡ˆä»¶çµŒéæ—¥æ•°",
          "formula": "DAYS({ä½œæˆæ—¥}, TODAY())",
          "description": "æ¡ˆä»¶ä½œæˆã‹ã‚‰ã®çµŒéæ—¥æ•°"
        },
        {
          "field_name": "å•†è«‡äºˆå®šã¾ã§",
          "formula": "IF({å•†è«‡äºˆå®šæ—¥} != BLANK(), DAYS(TODAY(), {å•†è«‡äºˆå®šæ—¥}), '')",
          "description": "å•†è«‡äºˆå®šæ—¥ã¾ã§ã®æ—¥æ•°"
        },
        {
          "field_name": "æ¡ˆä»¶ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è‰²",
          "formula": "SWITCH({å–¶æ¥­æ®µéš}, 'è¦‹è¾¼ã¿', 'ğŸ”µ', 'å•†è«‡', 'ğŸŸ¡', 'ææ¡ˆ', 'ğŸŸ ', 'æˆç´„', 'ğŸŸ¢', 'å®Œäº†', 'ğŸŸ£', 'å¤±æ³¨', 'ğŸ”´', '')",
          "description": "å–¶æ¥­æ®µéšã®è¦–è¦šçš„è¡¨ç¤º"
        }
      ],
      "tbl_customer_management": [
        {
          "field_name": "é–¢é€£æ¡ˆä»¶æ•°",
          "formula": "COUNT({å–¶æ¥­ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç®¡ç†})",
          "description": "ã“ã®é¡§å®¢ã«é–¢é€£ã™ã‚‹æ¡ˆä»¶æ•°"
        },
        {
          "field_name": "ç´¯è¨ˆå£²ä¸Š",
          "formula": "SUM(FILTER({å–¶æ¥­ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç®¡ç†.äºˆæƒ³å£²ä¸Šé‡‘é¡}, {å–¶æ¥­ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç®¡ç†.å–¶æ¥­æ®µéš} = 'å®Œäº†'))",
          "description": "å®Œäº†æ¡ˆä»¶ã®ç´¯è¨ˆå£²ä¸Š"
        },
        {
          "field_name": "æœ€çµ‚æ¥è§¦ã‹ã‚‰ã®æ—¥æ•°",
          "formula": "IF({æœ€çµ‚æ¥è§¦æ—¥} != BLANK(), DAYS({æœ€çµ‚æ¥è§¦æ—¥}, TODAY()), '')",
          "description": "æœ€çµ‚æ¥è§¦æ—¥ã‹ã‚‰ã®çµŒéæ—¥æ•°"
        },
        {
          "field_name": "é¡§å®¢ãƒ©ãƒ³ã‚¯",
          "formula": "IF({ç´¯è¨ˆå£²ä¸Š} >= 10000000, 'A', IF({ç´¯è¨ˆå£²ä¸Š} >= 5000000, 'B', IF({ç´¯è¨ˆå£²ä¸Š} >= 1000000, 'C', 'D')))",
          "description": "ç´¯è¨ˆå£²ä¸Šã«åŸºã¥ãé¡§å®¢ãƒ©ãƒ³ã‚­ãƒ³ã‚°"
        }
      ],
      "tbl_activity_history": [
        {
          "field_name": "æ´»å‹•ã‹ã‚‰æ¬¡å›äºˆå®šã¾ã§",
          "formula": "IF({æ¬¡å›äºˆå®šæ—¥} != BLANK(), DAYS({å®Ÿæ–½æ—¥}, {æ¬¡å›äºˆå®šæ—¥}), '')",
          "description": "æ´»å‹•å®Ÿæ–½æ—¥ã‹ã‚‰æ¬¡å›äºˆå®šæ—¥ã¾ã§ã®æœŸé–“"
        },
        {
          "field_name": "ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—çŠ¶æ³",
          "formula": "IF({æ¬¡å›äºˆå®šæ—¥} != BLANK(), IF({æ¬¡å›äºˆå®šæ—¥} < TODAY(), 'æœŸé™åˆ‡ã‚Œ', IF({æ¬¡å›äºˆå®šæ—¥} = TODAY(), 'æœ¬æ—¥äºˆå®š', 'äºˆå®šã‚ã‚Š')), 'äºˆå®šãªã—')",
          "description": "ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã®çŠ¶æ³"
        }
      ],
      "tbl_sales_targets": [
        {
          "field_name": "é”æˆç‡",
          "formula": "IF({æœˆæ¬¡å£²ä¸Šç›®æ¨™} != 0, {å®Ÿç¸¾å£²ä¸Š} / {æœˆæ¬¡å£²ä¸Šç›®æ¨™} * 100, 0)",
          "description": "æœˆæ¬¡å£²ä¸Šç›®æ¨™ã«å¯¾ã™ã‚‹é”æˆç‡"
        },
        {
          "field_name": "ç›®æ¨™å·®é¡",
          "formula": "{æœˆæ¬¡å£²ä¸Šç›®æ¨™} - {å®Ÿç¸¾å£²ä¸Š}",
          "description": "ç›®æ¨™ã¨å®Ÿç¸¾ã®å·®é¡"
        },
        {
          "field_name": "é”æˆçŠ¶æ³",
          "formula": "IF({é”æˆç‡} >= 100, 'âœ… é”æˆ', IF({é”æˆç‡} >= 80, 'âš ï¸ 80%ä»¥ä¸Š', IF({é”æˆç‡} >= 50, 'ğŸŸ¡ 50%ä»¥ä¸Š', 'ğŸ”´ 50%æœªæº€')))",
          "description": "é”æˆçŠ¶æ³ã®è¦–è¦šçš„è¡¨ç¤º"
        },
        {
          "field_name": "æœˆæ¬¡é€²æ—",
          "formula": "CONCATENATE(ROUND({é”æˆç‡}, 1), '%ï¼ˆ', {å®Ÿç¸¾å£²ä¸Š}, '/', {æœˆæ¬¡å£²ä¸Šç›®æ¨™}, 'å††ï¼‰')",
          "description": "é€²æ—çŠ¶æ³ã®ã‚µãƒãƒªãƒ¼è¡¨ç¤º"
        }
      ]
    },
    "conditional_formatting": {
      "tbl_sales_pipeline": [
        {
          "field": "å–¶æ¥­æ®µéš",
          "rules": [
            {"condition": "è¦‹è¾¼ã¿", "background_color": "#E3F2FD", "text_color": "#1976D2"},
            {"condition": "å•†è«‡", "background_color": "#FFF3E0", "text_color": "#F57C00"},
            {"condition": "ææ¡ˆ", "background_color": "#FFF8E1", "text_color": "#F9A825"},
            {"condition": "æˆç´„", "background_color": "#E8F5E8", "text_color": "#388E3C"},
            {"condition": "å®Œäº†", "background_color": "#F3E5F5", "text_color": "#7B1FA2"},
            {"condition": "å¤±æ³¨", "background_color": "#FFEBEE", "text_color": "#D32F2F"}
          ]
        },
        {
          "field": "ç¢ºåº¦",
          "rules": [
            {"condition": ">= 80", "background_color": "#E8F5E8", "text_color": "#388E3C"},
            {"condition": ">= 50", "background_color": "#FFF8E1", "text_color": "#F9A825"},
            {"condition": "< 50", "background_color": "#FFEBEE", "text_color": "#D32F2F"}
          ]
        }
      ],
      "tbl_customer_management": [
        {
          "field": "é¡§å®¢ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
          "rules": [
            {"condition": "VIPå®¢", "background_color": "#FFF3E0", "text_color": "#E65100"},
            {"condition": "æ—¢å­˜å®¢", "background_color": "#E8F5E8", "text_color": "#388E3C"},
            {"condition": "è¦‹è¾¼ã¿å®¢", "background_color": "#E3F2FD", "text_color": "#1976D2"},
            {"condition": "ä¼‘çœ å®¢", "background_color": "#F5F5F5", "text_color": "#616161"}
          ]
        }
      ],
      "tbl_sales_targets": [
        {
          "field": "é”æˆç‡",
          "rules": [
            {"condition": ">= 100", "background_color": "#E8F5E8", "text_color": "#388E3C"},
            {"condition": ">= 80", "background_color": "#FFF8E1", "text_color": "#F9A825"},
            {"condition": "< 80", "background_color": "#FFEBEE", "text_color": "#D32F2F"}
          ]
        }
      ]
    }
  },
  "notification_templates": {
    "pipeline_stagnation": {
      "title": "æ¡ˆä»¶åœæ»ã‚¢ãƒ©ãƒ¼ãƒˆ",
      "message": "æ¡ˆä»¶ã€Œ{æ¡ˆä»¶å}ã€ãŒ{åœæ»æ—¥æ•°}æ—¥é–“æ›´æ–°ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\né¡§å®¢: {é¡§å®¢å}\näºˆæƒ³å£²ä¸Š: {äºˆæƒ³å£²ä¸Šé‡‘é¡}å††\næ‹…å½“è€…: {æ‹…å½“è€…}\n\næ—©æ€¥ãªå¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",
      "priority": "high"
    },
    "followup_overdue": {
      "title": "ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æœŸé™åˆ‡ã‚Œ",
      "message": "é¡§å®¢ã€Œ{é¡§å®¢å}ã€ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æœŸé™ãŒéãã¦ã„ã¾ã™ã€‚\näºˆå®šå†…å®¹: {æ¬¡å›äºˆå®šå†…å®¹}\näºˆå®šæ—¥: {æ¬¡å›äºˆå®šæ—¥}\n\nè‡³æ€¥å¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",
      "priority": "medium"
    },
    "target_progress": {
      "title": "æœˆæ¬¡ç›®æ¨™é€²æ—é€šçŸ¥",
      "message": "æœˆæ¬¡å£²ä¸Šç›®æ¨™ã®é€²æ—çŠ¶æ³ã‚’ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚\n\næ‹…å½“è€…: {æ‹…å½“è€…}\nç›®æ¨™: {æœˆæ¬¡å£²ä¸Šç›®æ¨™}å††\nå®Ÿç¸¾: {å®Ÿç¸¾å£²ä¸Š}å††\né”æˆç‡: {é”æˆç‡}%\n\næœˆæœ«ã¾ã§æ®‹ã‚Š{æ®‹ã‚Šæ—¥æ•°}æ—¥ã§ã™ã€‚",
      "priority": "medium"
    },
    "high_value_deal": {
      "title": "é«˜é¡æ¡ˆä»¶æˆç´„",
      "message": "ğŸ‰ é«˜é¡æ¡ˆä»¶ãŒæˆç´„ã—ã¾ã—ãŸï¼\n\næ¡ˆä»¶å: {æ¡ˆä»¶å}\né¡§å®¢å: {é¡§å®¢å}\nå£²ä¸Šé‡‘é¡: {äºˆæƒ³å£²ä¸Šé‡‘é¡}å††\næ‹…å½“è€…: {æ‹…å½“è€…}\n\nãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼",
      "priority": "low"
    }
  }
}