# System Architecture / ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

## ğŸŒ Language / è¨€èª

[English](#english) | [æ—¥æœ¬èª](#japanese)

---

## English

### System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Client Layer                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Claude Desktop App    â”‚    Lark Client      â”‚     Web Browser         â”‚
â”‚   - MCP Integration     â”‚    - Bot Interface  â”‚     - Dashboard         â”‚
â”‚   - Chat Interface      â”‚    - Webhooks       â”‚     - Genesis UI        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Application Layer                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     MCP Server          â”‚   Lark OpenAPI      â”‚    Genesis Engine       â”‚
â”‚   - STDIO Server        â”‚   - Auth Service    â”‚   - Parser              â”‚
â”‚   - SSE Server          â”‚   - API Gateway     â”‚   - Generator           â”‚
â”‚   - Tool Registry       â”‚   - Event Handler   â”‚   - Validator           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Service Layer                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Chat Agent Service    â”‚  Document Service   â”‚   Base Service          â”‚
â”‚   - NLP Processing      â”‚  - Recall Engine    â”‚   - Table Management    â”‚
â”‚   - Context Management  â”‚  - Search & Index   â”‚   - Field Definition    â”‚
â”‚   - Response Generation â”‚  - Permission Mgmt  â”‚   - Formula Engine      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Integration Layer                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Rate Limiter          â”‚   HTTP Client       â”‚   WebSocket Manager     â”‚
â”‚   - Request Queue       â”‚   - Retry Logic     â”‚   - Event Streaming     â”‚
â”‚   - Throttling          â”‚   - Auth Headers    â”‚   - Connection Pool     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Data Layer                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Lark Base Storage     â”‚  Local File System  â”‚   Cache Layer           â”‚
â”‚   - Tables              â”‚  - Config Files     â”‚   - Redis/Memory        â”‚
â”‚   - Documents           â”‚  - Templates        â”‚   - Session Storage     â”‚
â”‚   - Media Files         â”‚  - Logs             â”‚   - Rate Limit State    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Core Components

#### 1. MCP Server Architecture

```typescript
// MCP Server Structure
mcp-server/
â”œâ”€â”€ stdio.ts      // Standard I/O communication
â”œâ”€â”€ sse.ts        // Server-Sent Events
â”œâ”€â”€ shared/       // Shared utilities
â”‚   â”œâ”€â”€ init.ts   // Initialization logic
â”‚   â””â”€â”€ types.ts  // TypeScript definitions
```

**Key Features:**
- Bidirectional communication with Claude Desktop
- Tool registration and execution
- Context preservation across sessions
- Error handling and recovery

#### 2. Lark Integration Architecture

```typescript
// Lark API Integration Flow
Client Request â†’ Rate Limiter â†’ API Gateway â†’ Service Handler â†’ Lark API
                      â†“                             â†“
                 Rate Check                    Response Processing
                      â†“                             â†“
                Queue/Reject â† â”€ â”€ â”€ â”€ â”€ â”€ â”€  Transform & Return
```

**Components:**
- **Authentication**: OAuth2 flow with tenant tokens
- **Rate Limiting**: Intelligent request queuing
- **API Gateway**: Unified interface for all Lark services
- **Event Handling**: Webhook and bot event processing

#### 3. Genesis System Architecture

```
Requirements Document
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Requirement     â”‚
â”‚    Parser        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Model     â”‚â”€â”€â”€â”€â–¶â”‚    Validator     â”‚
â”‚   Extractor      â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lark Base       â”‚â”€â”€â”€â”€â–¶â”‚  Error Recovery  â”‚
â”‚   Builder        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Deployment     â”‚
â”‚    Manager       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Communication Protocols

#### 1. MCP Protocol
- JSON-RPC 2.0 over stdio
- Server-Sent Events for real-time updates
- Tool invocation with structured parameters

#### 2. Lark API Protocol
- RESTful HTTP/HTTPS
- OAuth2 authentication
- Webhook callbacks for events

#### 3. Internal Communication
- TypeScript interfaces for type safety
- Event-driven architecture
- Promise-based async operations

### Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Security Layer    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Token Management  â”‚
â”‚ â€¢ Rate Limiting     â”‚
â”‚ â€¢ Input Validation  â”‚
â”‚ â€¢ Error Sanitizationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Security Features:**
- Secure token storage
- Request validation
- Rate limiting per tenant
- Audit logging
- Error message sanitization

---

## Japanese

### ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå±¤                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Claude Desktop App    â”‚    Larkã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ  â”‚     Webãƒ–ãƒ©ã‚¦ã‚¶         â”‚
â”‚   - MCPçµ±åˆ            â”‚    - ãƒœãƒƒãƒˆIF       â”‚     - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰     â”‚
â”‚   - ãƒãƒ£ãƒƒãƒˆIF         â”‚    - Webhook        â”‚     - Genesis UI        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     MCPã‚µãƒ¼ãƒãƒ¼         â”‚   Lark OpenAPI      â”‚    Genesisã‚¨ãƒ³ã‚¸ãƒ³      â”‚
â”‚   - STDIOã‚µãƒ¼ãƒãƒ¼       â”‚   - èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹     â”‚   - ãƒ‘ãƒ¼ã‚µãƒ¼            â”‚
â”‚   - SSEã‚µãƒ¼ãƒãƒ¼         â”‚   - APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤  â”‚   - ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼      â”‚
â”‚   - ãƒ„ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ãƒˆãƒª    â”‚   - ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©  â”‚   - ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ã‚µãƒ¼ãƒ“ã‚¹å±¤                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ãƒãƒ£ãƒƒãƒˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ  â”‚  ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ â”‚   Baseã‚µãƒ¼ãƒ“ã‚¹          â”‚
â”‚   - NLPå‡¦ç†            â”‚  - Recallã‚¨ãƒ³ã‚¸ãƒ³    â”‚   - ãƒ†ãƒ¼ãƒ–ãƒ«ç®¡ç†        â”‚
â”‚   - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†    â”‚  - æ¤œç´¢ãƒ»ç´¢å¼•        â”‚   - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©      â”‚
â”‚   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆ      â”‚  - æ¨©é™ç®¡ç†          â”‚   - æ•°å¼ã‚¨ãƒ³ã‚¸ãƒ³        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         çµ±åˆå±¤                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒã‚¿ãƒ¼      â”‚   HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ    â”‚   WebSocketãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ â”‚
â”‚   - ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚­ãƒ¥ãƒ¼    â”‚   - ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯  â”‚   - ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°â”‚
â”‚   - ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°      â”‚   - èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼      â”‚   - ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ãƒ‡ãƒ¼ã‚¿å±¤                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Lark Baseã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸   â”‚  ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«    â”‚   ã‚­ãƒ£ãƒƒã‚·ãƒ¥å±¤          â”‚
â”‚   - ãƒ†ãƒ¼ãƒ–ãƒ«           â”‚  - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«      â”‚   - Redis/ãƒ¡ãƒ¢ãƒª        â”‚
â”‚   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ       â”‚  - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ      â”‚   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ â”‚
â”‚   - ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«    â”‚  - ãƒ­ã‚°             â”‚   - ãƒ¬ãƒ¼ãƒˆåˆ¶é™çŠ¶æ…‹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 1. MCPã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```typescript
// MCPã‚µãƒ¼ãƒãƒ¼æ§‹é€ 
mcp-server/
â”œâ”€â”€ stdio.ts      // æ¨™æº–å…¥å‡ºåŠ›é€šä¿¡
â”œâ”€â”€ sse.ts        // Server-Sent Events
â”œâ”€â”€ shared/       // å…±æœ‰ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ init.ts   // åˆæœŸåŒ–ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ types.ts  // TypeScriptå®šç¾©
```

**ä¸»ãªæ©Ÿèƒ½:**
- Claude Desktopã¨ã®åŒæ–¹å‘é€šä¿¡
- ãƒ„ãƒ¼ãƒ«ã®ç™»éŒ²ã¨å®Ÿè¡Œ
- ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¿æŒ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªã‚«ãƒãƒªãƒ¼

#### 2. Larkçµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```typescript
// Lark APIçµ±åˆãƒ•ãƒ­ãƒ¼
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ â†’ ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒã‚¿ãƒ¼ â†’ APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ â†’ ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ â†’ Lark API
                           â†“                                    â†“
                      ãƒ¬ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯                        ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†
                           â†“                                    â†“
                    ã‚­ãƒ¥ãƒ¼/æ‹’å¦ â† â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€  å¤‰æ›ï¼†è¿”å´
```

**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:**
- **èªè¨¼**: ãƒ†ãƒŠãƒ³ãƒˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ãŸOAuth2ãƒ•ãƒ­ãƒ¼
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°
- **APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**: ã™ã¹ã¦ã®Larkã‚µãƒ¼ãƒ“ã‚¹ã®çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†**: Webhookã¨Botã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†

#### 3. Genesisã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
è¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¦ä»¶ãƒ‘ãƒ¼ã‚µãƒ¼     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«     â”‚â”€â”€â”€â”€â–¶â”‚  ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼     â”‚
â”‚  æŠ½å‡ºå™¨          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lark Base       â”‚â”€â”€â”€â”€â–¶â”‚  ã‚¨ãƒ©ãƒ¼ãƒªã‚«ãƒãƒªãƒ¼  â”‚
â”‚  ãƒ“ãƒ«ãƒ€ãƒ¼        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ   â”‚
â”‚  ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«

#### 1. MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«
- stdioçµŒç”±ã®JSON-RPC 2.0
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ç”¨ã®Server-Sent Events
- æ§‹é€ åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—

#### 2. Lark APIãƒ—ãƒ­ãƒˆã‚³ãƒ«
- RESTful HTTP/HTTPS
- OAuth2èªè¨¼
- ã‚¤ãƒ™ãƒ³ãƒˆç”¨ã®Webhookã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯

#### 3. å†…éƒ¨é€šä¿¡
- å‹å®‰å…¨æ€§ã®ãŸã‚ã®TypeScriptã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- Promiseãƒ™ãƒ¼ã‚¹ã®éåŒæœŸæ“ä½œ

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å±¤      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†      â”‚
â”‚ â€¢ ãƒ¬ãƒ¼ãƒˆåˆ¶é™        â”‚
â”‚ â€¢ å…¥åŠ›æ¤œè¨¼         â”‚
â”‚ â€¢ ã‚¨ãƒ©ãƒ¼ã‚µãƒ‹ã‚¿ã‚¤ã‚º   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½:**
- ã‚»ã‚­ãƒ¥ã‚¢ãªãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¤œè¨¼
- ãƒ†ãƒŠãƒ³ãƒˆæ¯ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- ç›£æŸ»ãƒ­ã‚°
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º

---

## ğŸ”— Related Documentation / é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [System Overview](README.md) - General system introduction
- [MCP Server Details](../03-TECHNICAL/MCP_SERVER.md) - MCP server implementation
- [API Reference](../03-TECHNICAL/API_REFERENCE.md) - Complete API documentation

---

Last Updated: 2025-01-24