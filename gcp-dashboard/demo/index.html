<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚨 緊急注文対応ダッシュボード</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background-color: #f8f9fa;
            color: #212529;
            line-height: 1.5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            margin-bottom: 30px;
        }
        
        h1 { 
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .last-update { 
            color: #6c757d; 
            font-size: 0.9rem; 
            margin-bottom: 30px;
        }
        
        /* メトリクスカード */
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .metric-title {
            font-size: 0.875rem;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #212529;
            line-height: 1.2;
        }
        
        .metric-value.emergency { color: #dc3545; }
        .metric-value.warning { color: #fd7e14; }
        
        /* チャートエリア */
        .charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .chart-container h2 {
            font-size: 1.25rem;
            margin-bottom: 20px;
            color: #212529;
            font-weight: 600;
        }
        
        .chart-wrapper {
            flex: 1;
            position: relative;
        }
        
        /* テーブル */
        .critical-table {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            overflow-x: auto;
        }
        
        .critical-table h2 {
            font-size: 1.25rem;
            margin-bottom: 20px;
            color: #212529;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }
        
        th, td {
            text-align: left;
            padding: 12px 16px;
            border-bottom: 1px solid #dee2e6;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        /* バッジ */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-danger { 
            background-color: #dc3545; 
            color: white; 
        }
        
        .badge-warning { 
            background-color: #fd7e14; 
            color: white; 
        }
        
        .badge-success {
            background-color: #28a745;
            color: white;
        }
        
        /* アニメーション */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* レスポンシブ */
        @media (max-width: 768px) {
            .charts { 
                grid-template-columns: 1fr; 
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .metric-value {
                font-size: 2rem;
            }
        }
        
        /* ローディング */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100px;
            color: #6c757d;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🚨 緊急注文対応ダッシュボード</h1>
            <div class="last-update">最終更新: <span id="lastUpdate">2025/01/18 15:30:00</span></div>
        </header>

        <!-- 主要指標 -->
        <div class="metrics">
            <div class="metric-card">
                <div class="metric-title">総商品数</div>
                <div class="metric-value">1,234</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">緊急発注商品</div>
                <div class="metric-value emergency pulse">56</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">発注待ち商品</div>
                <div class="metric-value warning">23</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">7日以内に在庫切れ</div>
                <div class="metric-value emergency">12</div>
            </div>
        </div>

        <!-- チャート -->
        <div class="charts">
            <div class="chart-container">
                <h2>📊 在庫切れ予測分布</h2>
                <div class="chart-wrapper">
                    <canvas id="stockoutChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h2>📈 売上TOP10商品</h2>
                <div class="chart-wrapper">
                    <canvas id="topSellersChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 緊急対応商品リスト -->
        <div class="critical-table">
            <h2>⚠️ 緊急対応が必要な商品（7日以内に在庫切れ）</h2>
            <table>
                <thead>
                    <tr>
                        <th>商品名</th>
                        <th>在庫切れまで</th>
                        <th>現在庫数</th>
                        <th>発注残数</th>
                        <th>30日販売数</th>
                        <th>ステータス</th>
                    </tr>
                </thead>
                <tbody id="criticalProductsTable">
                    <tr>
                        <td><strong>プレミアムコーヒー豆 1kg</strong></td>
                        <td><span class="badge badge-danger">2日</span></td>
                        <td>15</td>
                        <td><span class="badge badge-warning">50</span></td>
                        <td>380</td>
                        <td><span class="badge badge-danger">至急対応</span></td>
                    </tr>
                    <tr>
                        <td><strong>オーガニック紅茶セット</strong></td>
                        <td><span class="badge badge-danger">3日</span></td>
                        <td>8</td>
                        <td>-</td>
                        <td>250</td>
                        <td><span class="badge badge-danger">至急対応</span></td>
                    </tr>
                    <tr>
                        <td><strong>チョコレートギフトボックス</strong></td>
                        <td><span class="badge badge-warning">5日</span></td>
                        <td>30</td>
                        <td><span class="badge badge-warning">100</span></td>
                        <td>420</td>
                        <td><span class="badge badge-warning">要対応</span></td>
                    </tr>
                    <tr>
                        <td><strong>手作りクッキー詰め合わせ</strong></td>
                        <td><span class="badge badge-warning">6日</span></td>
                        <td>45</td>
                        <td>-</td>
                        <td>180</td>
                        <td><span class="badge badge-warning">要対応</span></td>
                    </tr>
                    <tr>
                        <td><strong>季節限定ジャムセット</strong></td>
                        <td><span class="badge badge-warning">7日</span></td>
                        <td>22</td>
                        <td><span class="badge badge-success">75</span></td>
                        <td>165</td>
                        <td><span class="badge badge-warning">要対応</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // 現在時刻を表示
        function updateTime() {
            const now = new Date();
            const formatted = now.toLocaleString('ja-JP', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = formatted;
        }
        updateTime();
        setInterval(updateTime, 60000); // 1分ごとに更新

        // 在庫切れ予測分布チャート
        const stockoutCtx = document.getElementById('stockoutChart').getContext('2d');
        new Chart(stockoutCtx, {
            type: 'doughnut',
            data: {
                labels: ['7日以内', '14日以内', '30日以内', '30日以上'],
                datasets: [{
                    data: [12, 18, 26, 178],
                    backgroundColor: ['#dc3545', '#fd7e14', '#ffc107', '#28a745'],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            font: {
                                size: 14
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.parsed || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = ((value / total) * 100).toFixed(1);
                                return `${label}: ${value}商品 (${percentage}%)`;
                            }
                        }
                    }
                }
            }
        });

        // 売上TOP10チャート
        const topSellersData = [
            { name: 'プレミアムコーヒー豆', sales: 450, stock: 15, days: 2 },
            { name: 'チョコレートギフト', sales: 420, stock: 30, days: 5 },
            { name: 'オーガニック紅茶', sales: 380, stock: 8, days: 3 },
            { name: 'スペシャルティ緑茶', sales: 320, stock: 120, days: 35 },
            { name: 'アーモンドクッキー', sales: 280, stock: 45, days: 8 },
            { name: '蜂蜜セット', sales: 250, stock: 200, days: 45 },
            { name: 'ドライフルーツMIX', sales: 220, stock: 85, days: 18 },
            { name: 'ナッツアソート', sales: 195, stock: 150, days: 40 },
            { name: '季節限定ジャム', sales: 165, stock: 22, days: 7 },
            { name: 'ハーブティーセット', sales: 150, stock: 95, days: 25 }
        ];

        const topSellersCtx = document.getElementById('topSellersChart').getContext('2d');
        new Chart(topSellersCtx, {
            type: 'bar',
            data: {
                labels: topSellersData.map(p => p.name),
                datasets: [{
                    label: '30日販売数',
                    data: topSellersData.map(p => p.sales),
                    backgroundColor: topSellersData.map(p => 
                        p.days <= 7 ? '#dc3545' : 
                        p.days <= 14 ? '#fd7e14' : 
                        p.days <= 30 ? '#ffc107' : '#0d6efd'
                    ),
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const product = topSellersData[context.dataIndex];
                                return [
                                    `在庫数: ${product.stock}`,
                                    `在庫切れ予測: ${product.days}日`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: {
                            display: false
                        }
                    },
                    y: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // データの自動更新をシミュレート
        function simulateDataUpdate() {
            // メトリクスの値を少しランダムに変更
            const metrics = document.querySelectorAll('.metric-value');
            metrics[1].textContent = Math.floor(Math.random() * 10 + 50); // 緊急発注商品
            metrics[2].textContent = Math.floor(Math.random() * 5 + 20);  // 発注待ち
            metrics[3].textContent = Math.floor(Math.random() * 5 + 10);  // 7日以内
        }

        // 10秒ごとにデータを更新（デモ用）
        setInterval(simulateDataUpdate, 10000);
    </script>
</body>
</html>