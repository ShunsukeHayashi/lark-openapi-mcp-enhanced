# YouTube CRM 営業自動化システム セットアップガイド

## 🎯 概要

このガイドでは、Lark Base上でYouTube CRM営業自動化システムをセットアップする手順を説明します。

## 📋 前提条件

1. **Lark Baseへのアクセス権限**
   - 管理者権限を持つアカウント
   - Base ID: `BI4RbpcKxaR7C2sLq9GjXJUjp2b`

2. **Lark開発者アカウント**
   - App ID と App Secret の取得
   - APIアクセス権限の設定

3. **必要なテーブル構造**
   - 商談管理テーブル
   - 顧客管理テーブル
   - 活動履歴テーブル
   - タスク管理テーブル

## 🚀 セットアップ手順

### ステップ1: 環境準備

1. **Node.js環境のセットアップ**
```bash
# Node.js (v14以上)がインストールされていることを確認
node --version

# プロジェクトディレクトリに移動
cd sales-automation

# 依存関係のインストール
npm install
```

2. **環境変数の設定**
```bash
# .env ファイルを作成
cat > .env << EOL
LARK_BASE_ID=BI4RbpcKxaR7C2sLq9GjXJUjp2b
LARK_APP_ID=your_app_id_here
LARK_APP_SECRET=your_app_secret_here
LARK_WEBHOOK_URL=your_webhook_url_here
EOL
```

### ステップ2: Lark Base設定

1. **Lark Baseにアクセス**
   - URL: https://f82jyx0mblu.jp.larksuite.com/base/BI4RbpcKxaR7C2sLq9GjXJUjp2b
   - 管理者権限でログイン

2. **必要なテーブルの確認/作成**

#### 商談管理テーブル
| フィールド名 | タイプ | 必須 | 説明 |
|------------|--------|------|------|
| 商談名 | テキスト | ✓ | 商談の名称 |
| 顧客名 | 関連レコード | ✓ | 顧客管理テーブルとリンク |
| 担当者 | ユーザー | ✓ | 営業担当者 |
| ステージ | 選択肢 | ✓ | 新規/商談化/提案/交渉/成約/失注 |
| 予想金額 | 通貨 | ✓ | 予想される商談金額 |
| 成約確度 | パーセント | ✓ | 成約の可能性 |
| 予定成約日 | 日付 | ✓ | 予定されている成約日 |
| 最終活動日 | 日付 | ✓ | 最後に活動した日 |
| リスクフラグ | 選択肢 | | 低/中/高 |
| YouTube効果スコア | 数値 | | 動画の効果測定 |

#### 顧客管理テーブル
| フィールド名 | タイプ | 必須 | 説明 |
|------------|--------|------|------|
| 顧客名 | テキスト | ✓ | 顧客の名称 |
| 業界 | 選択肢 | ✓ | 業界分類 |
| 顧客ランク | 選択肢 | ✓ | 通常/重要/VIP |
| 担当者 | ユーザー | ✓ | 営業担当者 |
| 最終接触日 | 日付 | ✓ | 最後に接触した日 |
| 顧客ステータス | 選択肢 | ✓ | 新規/アクティブ/休眠/解約 |
| 関係性スコア | 数値 | | 関係性の強さ |

#### 活動履歴テーブル
| フィールド名 | タイプ | 必須 | 説明 |
|------------|--------|------|------|
| 活動日時 | 日時 | ✓ | 活動を行った日時 |
| 活動タイプ | 選択肢 | ✓ | 電話/メール/ミーティング/YouTube動画送付等 |
| 関連商談 | 関連レコード | | 商談管理テーブルとリンク |
| 関連顧客 | 関連レコード | ✓ | 顧客管理テーブルとリンク |
| 担当者 | ユーザー | ✓ | 活動を行った担当者 |
| 詳細 | テキスト | | 活動の詳細内容 |
| 動画ID | テキスト | | YouTube動画のID（動画送付の場合） |

### ステップ3: 自動化ルールの実装

1. **基本自動化スクリプトの実行**
```bash
# Lark Base自動化ルールの設定
node scripts/lark-base-automation.js
```

このスクリプトは以下を自動的に設定します：
- 商談フォローアップルール
- 顧客接触管理ルール
- YouTube動画フォローアップ
- カスタムフィールドの作成
- ビューの作成
- ダッシュボードの設定

2. **手動設定が必要な項目**

#### 自動化ルールの有効化
1. Lark Base管理画面で「自動化」タブを開く
2. 作成されたルールを確認
3. 各ルールの「有効」スイッチをONにする

#### 通知設定
1. 「設定」→「通知」を開く
2. 通知チャネルを設定：
   - メール通知: SMTPサーバー情報を入力
   - Lark通知: Webhook URLを設定
   - Slack通知: Slack App連携を設定

### ステップ4: レポート機能の設定

1. **レポート生成スクリプトのテスト**
```bash
# 日次レポートのテスト生成
node scripts/report-generator.js daily

# 週次レポートのテスト生成
node scripts/report-generator.js weekly

# 月次レポートのテスト生成
node scripts/report-generator.js monthly
```

2. **自動レポート生成の開始**
```bash
# スケジューラーを起動（バックグラウンドで実行推奨）
nohup node scripts/report-generator.js scheduler &
```

### ステップ5: 権限とアクセス制御

1. **ユーザーロールの設定**
   - 営業担当者: 読み書き権限
   - マネージャー: 全権限
   - 役員: 読み取り専用（レポートのみ）

2. **データセキュリティ**
   - 機密フィールドの暗号化
   - アクセスログの有効化
   - 定期的なバックアップ設定

## 🔧 トラブルシューティング

### よくある問題と解決方法

1. **API接続エラー**
   - App IDとApp Secretが正しいか確認
   - APIの利用制限に達していないか確認
   - ネットワーク接続を確認

2. **自動化ルールが動作しない**
   - ルールが有効になっているか確認
   - トリガー条件が正しく設定されているか確認
   - エラーログを確認

3. **レポートが生成されない**
   - データが存在するか確認
   - 権限設定を確認
   - スケジューラーが起動しているか確認

## 📞 サポート

問題が解決しない場合は、以下の情報を添えてサポートにお問い合わせください：
- エラーメッセージ
- 実行したコマンド
- 環境情報（Node.jsバージョン等）
- Lark Baseのスクリーンショット

## 🎉 セットアップ完了

すべての手順が完了したら、以下を確認してください：

- [ ] 自動化ルールが正常に動作している
- [ ] レポートが定期的に生成されている
- [ ] 通知が適切に送信されている
- [ ] ダッシュボードでデータが確認できる

セットアップが完了したら、[自動化ガイド](automation-guide.md)に進んで詳細な使用方法を確認してください。